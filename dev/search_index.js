var documenterSearchIndex = {"docs":
[{"location":"#SpatialBernoulli","page":"Content","title":"SpatialBernoulli","text":"Documentation for SpatialBernoulli.\n\n","category":"section"},{"location":"#SpatialBernoulli.SB","page":"Content","title":"SpatialBernoulli.SB","text":"SB{TR<:Real, TS<:Real, TO<:Real, AV<:AbstractVector, AM<:AbstractMatrix, AAM<:AbstractMatrix}\n\nDefines a discrete multivariate distribution SB using a latend Gaussian process. The latent covarience matrix is definied by a Matern covariance (range, sill, order).  The marginal Bernoulli probabilities are given by λ.\n\n\n\n\n\n","category":"type"},{"location":"#SpatialBernoulli.SB-NTuple{5, Any}","page":"Content","title":"SpatialBernoulli.SB","text":"SB(range, sill, order, λ, h)\n\nConstructor for a discrete multivariate distribution SB using a latend Gaussian process. The latent covarience matrix is definied by a Matern covariance (range, sill, order).  The marginal Bernoulli probabilities are given by λ. The constructor used the distance martix to compute the covariance matrix.\n\n\n\n\n\n","category":"method"},{"location":"#Distributions.fit_mle-Tuple{SB, AbstractArray{<:Real}}","page":"Content","title":"Distributions.fit_mle","text":"fit_mle(d::SB, Y::AbstractArray{<:Real}[,wp::AbstractMatrix{<:Real}, w::AbstractVector{<:Real}]; solver = Optim.LBFGS(), m = 1000*length(d), return_sol = false, solkwargs...)\n\nReturn the (weigthed) MLE for the distribution d::SB. \n\nsolver choice of solver\nsolkwargs any keywords arguments that can be put inside the solve functions e.g. fit_mle(d, Y; maxiters = 2)\nw not necessary, used for using weighted loglikelihood instead of loglikelihood\nwp not technically  necessary, used for using pairwise loglikelihood instead of true loglikelihood. \n\n\n\n\n\n","category":"method"},{"location":"#Distributions.pdf-Tuple{SB, AbstractVector{<:Real}}","page":"Content","title":"Distributions.pdf","text":"pdf(d::SB, y::AbstractVector{<:Real}; m=length(d) * 100, return_error=false)\n\npdf(y) = CDF(N(mu,sigma))(0,...,0) is all there is to compute ! h(y) = int_-infty^0 dots int_-infty^0 pdf(mathcalN((-1)^y_ssigma_s phi^-1(lambda_s))Sigma U) recommended to use m= d1000 inside of MvNormalCDF, set to d100 as a starting point for this work (is quite ok)\n\n\n\n\n\n","category":"method"},{"location":"#SpatialBernoulli.matern-Tuple{Any}","page":"Content","title":"SpatialBernoulli.matern","text":"matern(h; range, sill, order) expkernel(h;range,sill) Define the matérn and exponential kernel. \n\n\n\n\n\n","category":"method"},{"location":"example/#Example","page":"Example","title":"Example","text":"using SpatialBernoulli \nusing Random","category":"section"},{"location":"example/#Parameters","page":"Example","title":"Parameters","text":"\n\n\n# define locations in the unit square\nmy_locations = vcat(([x y] for x in 0:0.2:1 for y in 0:0.2:1)...)\nnlocs = length(my_locations[:, 1])\n\n\nmy_distance = [sqrt(sum(abs2, my_locations[i, :] - my_locations[j, :])) for i in axes(my_locations, 1), j in axes(my_locations, 1)]\n\n# randomly generate a SpatialBernoulli\nmy_λ = rand(nlocs)# [0.5+ 0.1*i for i in 1:nlocs] \nmy_range = 0.3\nmy_sill = 1.0\nmy_order = 1 / 2\n","category":"section"},{"location":"example/#Create-the-mixed-distribution","page":"Example","title":"Create the mixed distribution","text":"d = SB(my_range, my_sill, my_order, my_λ, my_distance)\n\nuse it like any Distributions.jl distribution","category":"section"},{"location":"example/#Random-draws","page":"Example","title":"Random draws","text":"rng = MersenneTwister(1234)\n\nn = 2000\ny=rand(rng,d,n)\n\nusing CairoMakie\nyplot=y[:,2]\nbegin\nfig = Figure()\nax = Axis(fig[1, 1])\n\nscatter!(\n    ax,\n    my_locations[yplot .== 0, 1],\n    my_locations[yplot .== 0, 2];\n    color = :black,\n    label = \"y = 0\"\n)\n\nscatter!(\n    ax,\n    my_locations[yplot .== 1, 1],\n    my_locations[yplot .== 1, 2];\n    color = :white,\n    strokecolor = :black,\n    label = \"y = 1\"\n)\n\naxislegend(ax)\nfig\nend","category":"section"},{"location":"example/#Fitting","page":"Example","title":"Fitting","text":"init_range = 0.5\ninit_order = 1.5\ninit_lambda = fill(0.4, nlocs)\ninit_d = SB(init_range, 1.0, init_order, init_lambda, my_distance)\n\ntdist = maximum(my_distance) / 1\nwp = 1.0 .* (my_distance .< tdist)\n\n@timed sol3 = fit_mle_vfast(init_d, y, wp; order=my_order, return_sol=true, maxiters = 2000)\n","category":"section"}]
}
